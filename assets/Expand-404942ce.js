import{e as o,y as s,a as x,v,k as w}from"./Accessor-815cb0cf.js";import"./ensureType-125d327f.js";import"./typedArrayUtil-74bbfd45.js";import{e as h,W as y,n as r}from"./jsxFactory-2cf3af56.js";import{a as b,f as u,P as C}from"./reactiveUtils-31da19f9.js";import{e as m,t as E}from"./widget-dbfbe21d.js";import{t as f}from"./accessibleHandler-46d8c8f2.js";import"./watch-c7facfb0.js";import"./ArrayPool-ae2ef0ab.js";import"./string-75082bc6.js";import"./nextTick-3ee5a785.js";import"./promiseUtils-28f2a985.js";import"./Error-781981d1.js";import"./intl-b83d6b45.js";import"./number-5e819186.js";import"./cast-f7d2a22f.js";import"./locale-30120714.js";import"./messages-dc0c80a1.js";import"./request-b4e08038.js";import"./preload-helper-101896b7.js";import"./assets-fff829c9.js";import"./Evented-3dfb26f2.js";import"./Promise-092442f7.js";import"./uuid-73213768.js";let c=class extends v{constructor(e){super(e),this._viewpointHandle=null,this._handles=new w,this.group=null}initialize(){this._handles.add(b(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:t}=e;t&&t!==this&&t.expanded&&t.group&&t.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null,this._handles.destroy(),this._handles=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const t=!!e;this._set("expanded",t);const n=this.get("view.ui");n&&n.emit("expand",{target:this}),this._viewpointHandleChange(t)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&u(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?u(()=>this.view.stationary,()=>this._viewpointHandle.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this._handles.remove(e),this._viewpointHandle=null;const{autoCollapse:t,view:n}=this;if(n&&t){const d=C(()=>n.type==="3d"?n.camera:n.viewpoint,()=>this._collapse());this._handles.add(d,e),this._viewpointHandle=d}}_collapse(){this.expanded=!1}};o([s({value:!1})],c.prototype,"autoCollapse",null),o([s({value:!1})],c.prototype,"expanded",null),o([s()],c.prototype,"group",void 0),o([s({readOnly:!0})],c.prototype,"state",null),o([s({value:null})],c.prototype,"view",null),c=o([x("esri.widgets.Expand.ExpandViewModel")],c);const _=c,l="esri-expand",a={base:`${l} esri-widget`,modeAuto:`${l}--auto`,modeDrawer:`${l}--drawer`,modeFloating:`${l}--floating`,container:`${l}__container`,containerExpanded:`${l}__container--expanded`,panel:`${l}__panel`,button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:`${l}__icon--expanded`,iconNumber:`${l}__icon-number`,iconNumberExpanded:`${l}__icon-number--expanded`,expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:`${l}__content`,contentExpanded:`${l}__content--expanded`,expandMask:`${l}__mask`,expandMaskExpanded:`${l}__mask--expanded`};let i=class extends y{constructor(e,t){super(e,t),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new _,this._handleKeyDown=n=>{const{closeOnEsc:d,_toggleButtonEl:p,expanded:g}=this;!g||!d||n.target===p||n.key!=="Escape"||(typeof d=="function"?d(n):d)&&(this.expanded=!1,p==null||p.focus())}}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:t,collapseTooltip:n,expandTooltip:d}=this;return e?n||t.collapse:d||t.expand}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return a.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return m(this.content)?this.content.iconClass:a.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,t={[a.modeAuto]:e==="auto",[a.modeDrawer]:e==="drawer",[a.modeFloating]:e==="floating"};return r("div",{class:this.classes(a.base,t),onkeydown:this._handleKeyDown},this.renderMask(),this.renderContainer())}renderContainer(){const{expanded:e}=this,t={[a.containerExpanded]:e};return r("div",{class:this.classes(a.container,t)},this.renderPanel(),this.renderContent())}renderMask(){const{expanded:e}=this,t={[a.expandMaskExpanded]:e};return r("div",{bind:this,onclick:this._toggle,class:this.classes(a.expandMask,t)})}renderBadgeNumber(){const{expanded:e,iconNumber:t}=this;return t&&!e?r("span",{key:"expand__icon-number",class:a.iconNumber},t):null}renderPanelNumber(){const{iconNumber:e,expanded:t}=this;return e&&t?r("span",{key:"expand__expand-icon-number",class:this.classes(a.iconNumber,a.iconNumberExpanded)},e):null}renderIcon(){const{collapseIconClass:e,expandIconClass:t,expanded:n}=this,d={[a.iconExpanded]:n,[e]:n,[t]:!n};return e===t&&(d[e]=!0),r("span",{"aria-hidden":"true",class:this.classes(a.icon,d)})}renderTitle(){return r("span",{class:a.text},this.expandTitle)}renderExpandButton(){const{expanded:e,expandTitle:t,contentId:n}=this;return r("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":n,"aria-expanded":e?"true":"false",bind:this,class:a.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:t},this.renderBadgeNumber(),this.renderIcon(),this.renderTitle())}renderPanel(){return r("div",{class:a.panel},this.renderExpandButton(),this.renderPanelNumber())}renderContent(){const{expanded:e,contentId:t,content:n}=this,d={[a.contentExpanded]:e},p={id:t,role:"region",class:this.classes(a.content,d)};return typeof n=="string"?r("div",{key:"content__string",innerHTML:n,...p}):m(n)?r("div",{key:"content__widget",...p},n.render()):n instanceof HTMLElement?r("div",{key:"content__html-element",bind:n,afterCreate:this._attachToNode,...p}):E(n)?r("div",{key:"content__node",bind:n.domNode,afterCreate:this._attachToNode,...p}):null}_toggle(){this.toggle()}_attachToNode(e){const t=this;e.appendChild(t)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};o([s({readOnly:!0})],i.prototype,"contentId",null),o([s({readOnly:!0})],i.prototype,"expandTitle",null),o([s()],i.prototype,"autoCollapse",null),o([s()],i.prototype,"closeOnEsc",void 0),o([s()],i.prototype,"collapseIconClass",null),o([s()],i.prototype,"collapseTooltip",void 0),o([s()],i.prototype,"content",void 0),o([s()],i.prototype,"expanded",null),o([s()],i.prototype,"expandIconClass",null),o([s()],i.prototype,"expandTooltip",void 0),o([s()],i.prototype,"group",null),o([s()],i.prototype,"iconNumber",void 0),o([s()],i.prototype,"label",null),o([s(),h("esri/widgets/Expand/t9n/Expand")],i.prototype,"messages",void 0),o([s(),h("esri/t9n/common")],i.prototype,"messagesCommon",void 0),o([s()],i.prototype,"mode",void 0),o([s()],i.prototype,"view",null),o([s({type:_})],i.prototype,"viewModel",void 0),o([f()],i.prototype,"_toggle",null),i=o([x("esri.widgets.Expand")],i);const R=i;export{R as default};
