import{E as S,r as u,e as g,a as p,f as h,n as N,v as m}from"./Accessor-815cb0cf.js";import{N as E}from"./typedArrayUtil-74bbfd45.js";import{e as $,a as w,g as J}from"./JSONSupport-2b897629.js";import{p as v}from"./string-75082bc6.js";import{e as c}from"./watch-c7facfb0.js";class _{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(S),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const t=new _,r=this._originStores[u.DEFAULTS];r&&r.forEach((s,i)=>{t.set(i,v(s),u.DEFAULTS)});for(let s=u.SERVICE;s<S;s++){const i=this._originStores[s];i&&i.forEach((o,n)=>{e&&e.has(n)||t.set(n,v(o),s)})}return t}get(e,t){const r=t===void 0?this._values:this._originStores[t];return r?r.get(e):void 0}keys(e){const t=e==null?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,r=u.USER){let s=this._originStores[r];if(s||(s=new Map,this._originStores[r]=s),s.set(e,t),!this._values.has(e)||E(this._propertyOriginMap.get(e))<=r){const i=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),i!==t}return!1}delete(e,t=u.USER){const r=this._originStores[t];if(!r)return;const s=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(let i=t-1;i>=0;i--){const o=this._originStores[i];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,i);break}}}return s}has(e,t){const r=t===void 0?this._values:this._originStores[t];return!!r&&r.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;const r=this._originStores[t],s=r&&r.get(e),i=this._values.get(e);return this._values.set(e,s),this._propertyOriginMap.set(e,t),i!==s}originOf(e){return this._propertyOriginMap.get(e)||u.DEFAULTS}forEach(e){this._values.forEach(e)}}const M=a=>{let e=class extends a{constructor(...t){super(...t);const r=E(c(this)),s=r.store,i=new _;r.store=i,$(r,s,i)}read(t,r){w(this,t,r)}getAtOrigin(t,r){const s=O(this),i=h(r);if(typeof t=="string")return s.get(t,i);const o={};return t.forEach(n=>{o[n]=s.get(n,i)}),o}originOf(t){return N(this.originIdOf(t))}originIdOf(t){return O(this).originOf(t)}revert(t,r){const s=O(this),i=h(r),o=c(this);let n;n=typeof t=="string"?t==="*"?s.keys(i):[t]:t,n.forEach(l=>{o.invalidate(l),s.revert(l,i),o.commit(l)})}};return e=g([p("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function O(a){return c(a).store}let d=class extends M(m){};d=g([p("esri.core.ReadOnlyMultiOriginJSONSupport")],d);const A=a=>{let e=class extends a{constructor(...t){super(...t)}clear(t,r="user"){return f(this).delete(t,h(r))}write(t={},r){return J(this,t=t||{},r),t}setAtOrigin(t,r,s){c(this).setAtOrigin(t,r,h(s))}removeOrigin(t){const r=f(this),s=h(t),i=r.keys(s);for(const o of i)r.originOf(o)===s&&r.set(o,r.get(o,s),u.USER)}updateOrigin(t,r){const s=f(this),i=h(r),o=this.get(t);for(let n=i+1;n<S;++n)s.delete(t,n);s.set(t,o,i)}toJSON(t){return this.write({},t)}};return e=g([p("esri.core.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function f(a){return c(a).store}const x=a=>{let e=class extends A(M(a)){constructor(...r){super(...r)}};return e=g([p("esri.core.MultiOriginJSONSupport")],e),e};let y=class extends x(m){};y=g([p("esri.core.MultiOriginJSONSupport")],y);export{x as O,y as S};
