import{e as n,y as l,a as f}from"./Accessor-815cb0cf.js";import{j as c}from"./Collection-912f4315.js";import{r as h,t as m}from"./typedArrayUtil-74bbfd45.js";import"./string-75082bc6.js";import"./Error-781981d1.js";import{l as u}from"./watch-c7facfb0.js";import"./ensureType-125d327f.js";let r=class extends c{constructor(t){super(t),this.getCollections=null}initialize(){this.own(u(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const t=h(this.getCollections)?this.getCollections():null;if(m(t))return void this.removeAll();let e=0;for(const s of t)h(s)&&(e=this._processCollection(e,s));this.splice(e,this.length)}_createNewInstance(t){return new c(t)}_processCollection(t,e){if(!e)return t;const s=this.itemFilterFunction?this.itemFilterFunction:o=>!!o;for(const o of e)if(o){if(s(o)){const i=this.indexOf(o,t);i>=0?i!==t&&this.reorder(o,t):this.add(o,t),++t}if(this.getChildrenFunction){const i=this.getChildrenFunction(o);if(Array.isArray(i))for(const p of i)t=this._processCollection(t,p);else t=this._processCollection(t,i)}}return t}};n([l()],r.prototype,"getCollections",void 0),n([l()],r.prototype,"getChildrenFunction",void 0),n([l()],r.prototype,"itemFilterFunction",void 0),r=n([f("esri.core.CollectionFlattener")],r);const v=r;export{v as l};
