import{N as $,F as ye,a as _e,t as z,r as ge}from"./typedArrayUtil-74bbfd45.js";import{o as ve,i as u,a as D,f as q,k as be,g as me,e as Oe,b as we,c as m,d as $e,T as je}from"./watch-c7facfb0.js";import{p as X,h as Ae,a as Ee,o as j}from"./string-75082bc6.js";import{s as A,a as Q,r as Ce}from"./Error-781981d1.js";import{e as Se}from"./ArrayPool-ae2ef0ab.js";import{m as Te,S as R,_ as Ne,B as Ie,k as Y,M as U,$ as Me,w as Pe,j as De,b as ke}from"./ensureType-125d327f.js";function St(t,e,r,s){var n,o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,r,s);else for(var i=t.length-1;i>=0;i--)(n=t[i])&&(c=(o<3?n(c):o>3?n(e,r,c):n(e,r))||c);return o>3&&c&&Object.defineProperty(e,r,c),c}function Tt(t){const e=[];return function*(){yield*e;for(const r of t)e.push(r),yield r}}function Nt(t,e){for(const r of t)if(r!=null&&e(r))return r}function L(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let Ge=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(r=>{e+=r.length}),e}add(e,r){if(L(e)){const s=this._getOrCreateGroup(r);for(const n of e)this._isHandle(n)&&s.push(n)}else this._isHandle(e)&&this._getOrCreateGroup(r).push(e);return this}forEach(e,r){if(typeof e=="function")this._groups.forEach(s=>s.forEach(e));else{const s=this._getGroup(e);s&&r&&s.forEach(r)}}has(e){return this._groups.has(this._ensureGroupKey(e))}remove(e){if(typeof e!="string"&&L(e)){for(const r of e)this.remove(r);return this}return this.has(e)?(this._removeAllFromGroup(this._getGroup(e)),this._groups.delete(this._ensureGroupKey(e)),this):this}removeAll(){return this._groups.forEach(e=>this._removeAllFromGroup(e)),this._groups.clear(),this}_isHandle(e){return e&&!!e.remove}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const r=[];return this._groups.set(this._ensureGroupKey(e),r),r}_getGroup(e){return $(this._groups.get(this._ensureGroupKey(e)))}_ensureGroupKey(e){return e||"_default_"}_removeAllFromGroup(e){e.forEach(r=>r.remove())}};const ee=Symbol("Accessor-beforeDestroy");function v(t){let e=t.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!r){e=Object.create(e);for(const s in e)e[s]=X(e[s]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return $(t.constructor.__accessorMetadata__)}function te(t,e){const r=v(t);let s=r[e];return s||(s=r[e]={}),s}function ze(t,e){return ve(t,e,Ue)}const Re=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Ue(t){return Re.test(t)?"replace":"merge"}var h;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED"})(h||(h={}));let Le=class{constructor(e,r){this._observers=e,this._observer=r}remove(){ye(this._observers,this._observer)}},xe=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return He;this._observers==null&&(this._observers=[]);const r=this._observers;let s=!1,n=!1;const o=r.length;for(let c=0;c<o;++c){const i=r[c];if(i.destroyed)n=!0;else if(i===e){s=!0;break}}return s||(r.push(e),n&&this._removeDestroyedObservers()),new Le(r,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const r=e.length;let s=0;for(let n=0;n<r;++n){for(;n+s<r&&e[n+s].destroyed;)++s;if(s>0){if(!(n+s<r))break;e[n]=e[n+s]}}e.length=r-s}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const r of e)r.onCommitted();this._observers=null}}};const He={remove:()=>{}};var d;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.USER=6]="USER"})(d||(d={}));const Dt=d.USER+1;function Fe(t){switch(t){case"defaults":return d.DEFAULTS;case"service":return d.SERVICE;case"portal-item":return d.PORTAL_ITEM;case"web-scene":return d.WEB_SCENE;case"web-map":return d.WEB_MAP;case"user":return d.USER;default:return null}}function T(t){switch(t){case d.DEFAULTS:return"defaults";case d.SERVICE:return"service";case d.PORTAL_ITEM:return"portal-item";case d.WEB_SCENE:return"web-scene";case d.WEB_MAP:return"web-map";case d.USER:return"user"}return $(void 0)}function kt(t){return T(t)}let x=class{constructor(e,r,s){this.properties=e,this.propertyName=r,this.metadata=s,this.observerObject=new Ve,this._accessed=null,this._handles=null,this.observerObject.flags=u.Dirty|(s.nonNullable?u.NonNullable:0)|(s.hasOwnProperty("value")?u.HasDefaultValue:0)|(s.get===void 0?u.DepTrackingInitialized:0)|(s.dependsOn===void 0?u.AutoTracked:0),H.register(this,this.observerObject)}destroy(){this.observerObject.destroy(),this._accessed=null,this._clearObservationHandles(),H.unregister(this)}getComputed(){const e=this.observerObject;D(e);const r=this.properties.store,s=this.propertyName,n=e.flags,o=r.get(s);if(n&u.Computing||~n&u.Dirty&&r.has(s))return o;e.flags|=u.Computing;const c=this.properties.host;let i;n&u.AutoTracked?i=q(this,this.metadata.get,c):(be(c,this),i=this.metadata.get.call(c)),r.set(s,i,d.COMPUTED);const a=r.get(s);return a===o?e.flags&=~u.Dirty:me(this.commit,this),e.flags&=~u.Computing,a}onObservableAccessed(e){e!==this.observerObject&&(this._accessed===null&&(this._accessed=[]),this._accessed.includes(e)||this._accessed.push(e))}onTrackingEnd(){this._clearObservationHandles();const e=this.observerObject;e.flags|=u.DepTrackingInitialized;const r=this._accessed;if(r===null)return;let s=this._handles;s===null&&(s=this._handles=[]);for(let n=0;n<r.length;++n)s.push(r[n].observe(e));r.length=0}notifyChange(){const e=this.observerObject;e.onInvalidated(),e.onCommitted()}invalidate(){this.observerObject.onInvalidated()}commit(){const e=this.observerObject;e.flags&=~u.Dirty,e.onCommitted()}_clearObservationHandles(){const e=this._handles;if(e!==null){for(let r=0;r<e.length;++r)e[r].remove();e.length=0}}},Ve=class extends xe{constructor(){super(...arguments),this.flags=0}onInvalidated(){~this.flags&u.Overriden&&(this.flags|=u.Dirty);const e=this._observers;if(e&&e.length>0)for(const r of e)r.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const s of r)s.onCommitted()}}destroy(){this.flags&u.Dirty&&this.onCommitted(),super.destroy()}};const H=new FinalizationRegistry(t=>{t.destroy()});let Be=class re{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new re;return this._values.forEach((s,n)=>{e&&e.has(n)||r.set(n,X(s))}),r}get(e){return this._values.get(e)}originOf(){return d.USER}keys(){return[...this._values.keys()]}set(e,r){this._values.set(e,r)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function b(t,e,r){return t!==void 0}function F(t,e,r,s){return t!==void 0&&(!(r==null&&t.observerObject.flags&u.NonNullable)||(s.lifecycle,h.INITIALIZING,!1))}function We(t){return t&&typeof t.destroy=="function"}A.getLogger("esri.core.accessorSupport.Properties");class Ke{constructor(e){this.host=e,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=h.INITIALIZING,this.store=new Be,this._origin=d.USER;const r=$(this.host.constructor.__accessorMetadata__);for(const s in r){const n=new x(this,s,r[s]);this.properties.set(s,n)}this.metadatas=r}initialize(){this.lifecycle=h.CONSTRUCTING}constructed(){this.lifecycle=h.CONSTRUCTED}destroy(){this.destroyed=!0;for(const[e,r]of this.properties){if(r.metadata.autoDestroy){const s=this.internalGet(e);s&&We(s)&&(s.destroy(),~r.observerObject.flags&u.NonNullable&&this._internalSet(r,null))}r.destroy()}}get initialized(){return this.lifecycle!==h.INITIALIZING}get(e){const r=this.properties.get(e);if(r.metadata.get)return r.getComputed();D(r.observerObject);const s=this.store;return s.has(e)?s.get(e):r.metadata.value}originOf(e){const r=this.store.originOf(e);if(r===void 0){const s=this.properties.get(e);if(s!==void 0&&s.observerObject.flags&u.HasDefaultValue)return"defaults"}return T(r)}has(e){return!!this.properties.has(e)&&this.store.has(e)}keys(){return[...this.properties.keys()]}internalGet(e){const r=this.properties.get(e);if(b(r))return this.store.has(e)?this.store.get(e):r.metadata.value}internalSet(e,r){const s=this.properties.get(e);b(s)&&this._internalSet(s,r)}getDependsInfo(e,r,s){const n=this.properties.get(r);if(!b(n))return"";const o=new Set,c=q({onObservableAccessed:a=>o.add(a),onTrackingEnd:()=>{}},()=>{var a;return(a=n.metadata.get)==null?void 0:a.call(e)});let i=`${s}${e.declaredClass.split(".").pop()}.${r}: ${c}
`;if(o.size===0)return i;s+="  ";for(const a of o){if(!(a instanceof x))continue;const l=a.properties.host,p=a.propertyName,f=Oe(l);i+=f?f.getDependsInfo(l,p,s):`${s}${p}: undefined
`}return i}setAtOrigin(e,r,s){const n=this.properties.get(e);if(b(n))return this._setAtOrigin(n,r,s)}isOverridden(e){const r=this.properties.get(e);return r!==void 0&&!!(r.observerObject.flags&u.Overriden)}clearOverride(e){const r=this.properties.get(e),s=r==null?void 0:r.observerObject;s&&s.flags&u.Overriden&&(s.flags&=~u.Overriden,r.notifyChange())}override(e,r){const s=this.properties.get(e);if(!F(s,e,r,this))return;const n=s.metadata.cast;if(n){const o=this._cast(n,r),{valid:c,value:i}=o;if(E.release(o),!c)return;r=i}s.observerObject.flags|=u.Overriden,this._internalSet(s,r)}set(e,r){const s=this.properties.get(e);if(!F(s,e,r,this))return;const n=s.metadata.cast;if(n){const c=this._cast(n,r),{valid:i,value:a}=c;if(E.release(c),!i)return;r=a}const o=s.metadata.set;o?o.call(this.host,r):this._internalSet(s,r)}setDefaultOrigin(e){this._origin=Fe(e)}getDefaultOrigin(){return T(this._origin)}notifyChange(e){const r=this.properties.get(e);r!==void 0&&r.notifyChange()}invalidate(e){const r=this.properties.get(e);r!==void 0&&r.invalidate()}commit(e){const r=this.properties.get(e);r!==void 0&&r.commit()}_internalSet(e,r){const s=this.lifecycle!==h.INITIALIZING?this._origin:d.DEFAULTS;this._setAtOrigin(e,r,s)}_setAtOrigin(e,r,s){const n=this.store,o=e.propertyName;n.has(o,s)&&Ae(r,n.get(o))&&~e.observerObject.flags&u.Overriden&&s===n.originOf(o)||(e.invalidate(),n.set(o,r,s),e.commit(),we(this.host,e))}_cast(e,r){const s=E.acquire();return s.valid=!0,s.value=r,e&&(s.value=e.call(this.host,r,s)),s}}let Je=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const E=new Se(Je);function O(t,e,r){if(t&&e)if(typeof e=="object")for(const s of Object.getOwnPropertyNames(e))O(t,s,e[s]);else{if(e.includes(".")){const n=e.split("."),o=n.splice(n.length-1,1)[0];return void O(m(t,n),o,r)}const s=t.__accessor__;s!=null&&Ze(e,s),t[e]=r}}function Ze(t,e){if(Ee("esri-unknown-property-errors")&&!qe(t,e))throw new Q("set:unknown-property",Xe(t,e))}function qe(t,e){return e.metadatas[t]!=null}function Xe(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}function Qe(t={}){return(e,r)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${r}. Accessor does not support static properties.`);const s=Object.getOwnPropertyDescriptor(e,r),n=te(e,r);s&&(s.get||s.set?(n.get=s.get||n.get,n.set=s.set||n.set):"value"in s&&("value"in t&&A.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=s.value)),t.readOnly!=null&&(n.readOnly=t.readOnly);const o=t.aliasOf;if(o){const a=typeof o=="string"?o:o.source,l=typeof o=="string"?null:o.overridable===!0;let p;n.dependsOn=[a],n.get=function(){let f=m(this,a);if(typeof f=="function"){p||(p=a.split(".").slice(0,-1).join("."));const _=m(this,p);_&&(f=f.bind(_))}return f},n.readOnly||(n.set=l?function(f){this._override(r,f)}:function(f){O(this,a,f)})}const c=t.type,i=t.types;n.cast||(c?n.cast=Ye(c):i&&(Array.isArray(i)?n.cast=Te(R(i[0])):n.cast=R(i))),ze(n,t),t.range&&(n.cast=et(n.cast,t.range))}}function Ut(t,e,r){const s=te(t,r);s.json||(s.json={});let n=s.json;return e!==void 0&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function Ye(t){let e=0,r=t;if(Ne(t))return Ie(t);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],e++;const s=r;if(Y(s))return e===0?U(s):Me(U(s),e);if(e===1)return Pe(s);if(e>1)return De(s,e);const n=t;return n.from?n.from:ke(n)}function et(t,e){return r=>{let s=+t(r);return e.step!=null&&(s=Math.round(s/e.step)*e.step),e.min!=null&&(s=Math.max(e.min,s)),e.max!=null&&(s=Math.min(e.max,s)),s}}function tt(t){if(t.json&&t.json.origins){const e=t.json.origins,r={"web-document":["web-scene","web-map"]};for(const s in r)if(e[s]){const n=e[s];r[s].forEach(o=>{e[o]=n}),delete e[s]}}}let se=class N extends Ce{constructor(e,r,s){if(super(e,r,s),!(this instanceof N))return new N(e,r,s)}};se.prototype.type="warning";function ne(t){return!!t&&t.prototype&&t.prototype.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const I=A.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function V(t,e,r){var s,n;t&&(!r&&!e.read||(s=e.read)!=null&&s.reader||((n=e.read)==null?void 0:n.enabled)===!1||ot(t)&&j("read.reader",rt(t),e))}function rt(t){var r,s;const e=t.ndimArray??0;if(e>1)return nt(t);if(e===1)return B(t);if("type"in t&&ie(t.type)){const n=(s=(r=t.type.prototype)==null?void 0:r.itemType)==null?void 0:s.Type,o=B(typeof n=="function"?{type:n}:{types:n});return(c,i,a)=>{const l=o(c,i,a);return l&&new t.type(l)}}return k(t)}function k(t){return"type"in t?st(t.type):it(t.types)}function st(t){return t.prototype.read?(e,r,s)=>{if(e==null)return e;const n=typeof e;if(n!=="object")return void I.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const o=new t;return o.read(e,s),o}:t.fromJSON}function oe(t,e,r,s){return s!==0&&Array.isArray(e)?e.map(n=>oe(t,n,r,s-1)):t(e,void 0,r)}function nt(t){const e=k(t),r=oe.bind(null,e),s=t.ndimArray??0;return(n,o,c)=>{if(n==null)return n;n=r(n,c,s);let i=s,a=n;for(;i>0&&Array.isArray(a);)i--,a=a[0];if(a!==void 0)for(let l=0;l<i;l++)n=[n];return n}}function B(t){const e=k(t);return(r,s,n)=>{if(r==null)return r;if(Array.isArray(r)){const c=[];for(const i of r){const a=e(i,void 0,n);a!==void 0&&c.push(a)}return c}const o=e(r,void 0,n);return o!==void 0?[o]:void 0}}function ie(t){if(!ne(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?G(e.Type):ae(e.Type))}function ot(t){return"types"in t?ae(t.types):G(t.type)}function G(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||ie(t))}function ae(t){for(const e in t.typeMap)if(!G(t.typeMap[e]))return!1;return!0}function it(t){let e=null;const r=t.errorContext??"type";return(s,n,o)=>{if(s==null)return s;const c=typeof s;if(c!=="object")return void I.error(`Expected JSON value of type 'object' to deserialize, but got '${c}'`);e||(e=at(t));const i=t.key;if(typeof i!="string")return;const a=s[i],l=a?e[a]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!l){const f=`Type '${a||"unknown"}' is not supported`;return o&&o.messages&&s&&o.messages.push(new se(`${r}:unsupported`,f,{definition:s,context:o})),void I.error(f)}const p=new l;return p.read(s,o),p}}function at(t){var r,s;const e={};for(const n in t.typeMap){const o=t.typeMap[n],c=v(o.prototype);if(typeof t.key=="function")continue;const i=c[t.key];if(!i)continue;(r=i.json)!=null&&r.type&&Array.isArray(i.json.type)&&i.json.type.length===1&&typeof i.json.type[0]=="string"&&(e[i.json.type[0]]=o);const a=(s=i.json)==null?void 0:s.write;if(!a||!a.writer){e[n]=o;continue}const l=a.target,p=typeof l=="string"?l:t.key,f={};a.writer(n,f,p),f[p]&&(e[f[p]]=o)}return e}function ct(t){if(t.json||(t.json={}),K(t.json),J(t.json),W(t.json),t.json.origins)for(const e in t.json.origins)K(t.json.origins[e]),J(t.json.origins[e]),W(t.json.origins[e]);return!0}function W(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function K(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function J(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function Z(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const r=(t==null?void 0:t.ndimArray)??0;t&&(r===1||"type"in t&&ne(t.type))?e.write.writer=pt:r>1?e.write.writer=dt(r):e.types?Array.isArray(e.types)?e.write.writer=lt(e.types[0]):e.write.writer=ut(e.types):e.write.writer=g}function ut(t){return(e,r,s,n)=>e?ce(e,t,n)?g(e,r,s,n):void 0:g(e,r,s,n)}function ce(t,e,r){for(const s in e.typeMap)if(t instanceof e.typeMap[s])return!0;if(r!=null&&r.messages){const s=e.errorContext??"type",n=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&t&&r.messages.push(new Q(`${s}:unsupported`,n,{definition:t,context:r})),A.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function lt(t){return(e,r,s,n)=>!e||!Array.isArray(e)?g(e,r,s,n):g(e.filter(o=>ce(o,t,n)),r,s,n)}function g(t,e,r,s){j(r,w(t,s),e)}function w(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?ft(t):t}function ft(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function pt(t,e,r,s){let n;t===null?n=null:t&&typeof t.map=="function"?(n=t.map(o=>w(o,s)),typeof n.toArray=="function"&&(n=n.toArray())):n=[w(t,s)],j(r,n,e)}function ue(t,e,r){return r!==0&&Array.isArray(t)?t.map(s=>ue(s,e,r-1)):w(t,e)}function dt(t){return(e,r,s,n)=>{let o;if(e===null)o=null;else{o=ue(e,n,t);let c=t,i=o;for(;c>0&&Array.isArray(i);)c--,i=i[0];if(i!==void 0)for(let a=0;a<c;a++)o=[o]}j(s,o,r)}}function Lt(t,e){return le(t,"read",e)}function xt(t,e){return le(t,"write",e)}function le(t,e,r){let s=t&&t.json;if(t&&t.json&&t.json.origins&&r){const n=r.origin&&t.json.origins[r.origin];n&&(e==="any"||e in n)&&(s=n)}return s}function ht(t){const e=yt(t);if(t.json.origins)for(const r in t.json.origins){const s=t.json.origins[r],n=s.types?_t(s):e;V(n,s,!1),s.types&&!s.write&&t.json.write&&t.json.write.enabled&&(s.write={...t.json.write}),Z(n,s)}V(e,t.json,!0),Z(e,t.json)}function yt(t){return t.json.types?M(t.json):t.type?fe(t):M(t)}function _t(t){return t.type?fe(t):M(t)}function fe(t){if(!t.type)return;let e=0,r=t.type;for(;Array.isArray(r)&&!Y(r);)r=r[0],e++;return{type:r,ndimArray:e}}function M(t){if(!t.types)return;let e=0,r=t.types;for(;Array.isArray(r);)r=r[0],e++;return{types:r,ndimArray:e}}function gt(t){ct(t)&&(tt(t),ht(t))}const C=new Set,S=new Set;function vt(t){return e=>{e.prototype.declaredClass=t,mt(e);const r=[],s=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!C.has(n.initialize)&&(C.add(n.initialize),r.push(n.initialize)),n.hasOwnProperty("destroy")&&!S.has(n.destroy)&&(S.add(n.destroy),s.push(n.destroy)),n=Object.getPrototypeOf(n);C.clear(),S.clear();class o extends e{constructor(...i){if(super(...i),this.constructor===o&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let a=r.length-1;a>=0;a--)r[a].call(this)}}),s.length){let a=!1;const l=this[ee];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!a){a=!0,l.call(this);for(let p=0;p<s.length;p++)s[p].call(this)}}})}this.postscript(...i)}}}return o.__accessorMetadata__=v(e.prototype),o.prototype.declaredClass=t,o}}function bt(t,e){return e.get==null?function(){const r=this.__accessor__.properties.get(t);if(r===void 0)return;D(r.observerObject);const s=this.__accessor__.store;return s.has(t)?s.get(t):r.metadata.value}:function(){const r=this.__accessor__.properties.get(t);if(r!==void 0)return r.getComputed()}}function mt(t){const e=t.prototype,r=v(e),s={};for(const n of Object.getOwnPropertyNames(r)){const o=r[n];gt(o),s[n]={enumerable:!0,configurable:!0,get:bt(n,o),set(c){const i=this.__accessor__;if(i!==void 0){if(!Object.isFrozen(this)){if(i.initialized&&o.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${n}' of ${this.declaredClass}`);if(i.lifecycle===h.CONSTRUCTED&&o.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${n}' of ${this.declaredClass}`);i.set(n,c)}}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:c})}}}Object.defineProperties(t.prototype,s)}var pe,de;function Ot(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const y=Symbol("Accessor-Handles"),P=Symbol("Accessor-Initialized");let Ht=class he{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:s,constructor:n}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const o=this;class c extends o{constructor(...a){super(...a),this.inherited=null,n&&n.apply(this,a)}}v(c.prototype);for(const i in e){const a=e[i];c.prototype[i]=typeof a=="function"?function(...l){const p=this.inherited;let f;this.inherited=function(..._){if(o.prototype[i])return o.prototype[i].apply(this,_)};try{f=a.apply(this,l)}catch(_){throw this.inherited=p,_}return this.inherited=p,f}:e[i]}for(const i in r){const a=Ot(r[i]);Qe(a)(c.prototype,i)}return vt(s)(c)}constructor(...e){if(this[pe]=null,this[de]=!1,this.constructor===he)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new Ke(this)}),e.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,e))}postscript(e){const r=this.__accessor__,s=r.ctorArgs||e;r.initialize(),s&&(this.set(s),r.ctorArgs=null),r.constructed(),this.initialize(),this[P]=!0}initialize(){}[ee](){this[y]=_e(this[y])}destroy(){this.destroyed||($e(this),this.__accessor__.destroy())}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[P]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(e){this.get(e)}get(e){return m(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,r){return O(this,e,r),this}watch(e,r,s){return je(this,e,r,s)}own(e){this.addHandles(e)}addHandles(e,r){let s=this[y];z(s)&&(s=this[y]=new Ge),s.add(e,r)}removeHandles(e){const r=this[y];z(r)||r.remove(e)}hasHandles(e){const r=this[y];return!!ge(r)&&r.has(e)}_override(e,r){r===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,r){r==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,r){return this.__accessor__.internalSet(e,r),this}};pe=y,de=P;export{Dt as E,vt as a,le as b,te as c,kt as d,St as e,Fe as f,se as g,Ut as h,ft as i,xe as j,Ge as k,L as l,Tt as m,T as n,Nt as o,et as p,d as r,xt as s,Lt as t,rt as u,Ht as v,Qe as y};
