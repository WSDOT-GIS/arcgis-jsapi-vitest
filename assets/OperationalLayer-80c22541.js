import{e as t,y,a as u}from"./Accessor-815cb0cf.js";import{a as p}from"./Error-781981d1.js";import{Z as g}from"./request-ae7029ea.js";import"./ensureType-125d327f.js";import"./typedArrayUtil-74bbfd45.js";import{r as l}from"./Extent-8fae2379.js";import{c as m,d as I}from"./JSONSupport-2b897629.js";import{S as G,u as v}from"./commonProperties-64b016df.js";const w={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0}},B=d=>{let r=class extends d{constructor(){super(...arguments),this.title=null}writeListMode(a,e,i,n){(n&&n.layerContainerType==="ground"||a&&m(this,i,{},n))&&(e[i]=a)}writeOperationalLayerType(a,e,i,n){!a||n&&n.layerContainerType==="tables"||(e.layerType=a)}writeTitle(a,e){e.title=a??"Layer"}read(a,e){e&&(e.layer=this),I(this,a,i=>super.read(a,i),e)}write(a,e){var c,S;if(e!=null&&e.origin){const o=`${e.origin}/${e.layerContainerType||"operational-layers"}`,L=w[o];let s=L&&L[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&o==="web-scene/operational-layers"&&(s=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&o==="web-map/operational-layers"&&(s=!1),!s)return(c=e.messages)==null||c.push(new p("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${o}'`,{layer:this})),null}const i=super.write(a,{...e,layer:this}),n=!!e&&!!e.messages&&!!e.messages.filter(o=>o instanceof p&&o.name==="web-document-write:property-required").length;return g(i==null?void 0:i.url)?((S=e==null?void 0:e.messages)==null||S.push(new p("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:i}beforeSave(){}};return t([y({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],r.prototype,"id",void 0),t([y(G)],r.prototype,"listMode",void 0),t([l("listMode")],r.prototype,"writeListMode",null),t([y({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],r.prototype,"operationalLayerType",void 0),t([l("operationalLayerType")],r.prototype,"writeOperationalLayerType",null),t([y(v)],r.prototype,"opacity",void 0),t([y({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],r.prototype,"title",void 0),t([l("title"),l(["web-scene"],"title")],r.prototype,"writeTitle",null),t([y({type:Boolean,json:{name:"visibility"}})],r.prototype,"visible",void 0),r=t([u("esri.layers.mixins.OperationalLayer")],r),r};export{B as c};
